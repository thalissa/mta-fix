{"_id":"JXhBGZksw0AvXB1d","name":"+1 Beats (End of Session)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_session.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgress(\"End of Session\", 1, 0);\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got a Beat for end of session!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.TzOogDZrS3OcOZLz"}}}
{"name":"Show Beats Total","type":"script","author":"rr0EVDhTVIBqlfEm","img":"systems/mta/icons/macros/beats-total.svg","scope":"global","command":"const ids = [];\n// Example: const ids = [[\"Tylor\", \"1a02UQZRhupn5234\"], [\"April\", \"bGgpNeYcBWVCdhAk\"], [\"Elaine\", \"hOppsrlQbSCyjjFw\"]]; \n\nfor(let token of canvas.tokens.controlled){\n    if(token){\n        if(token.actor){\n            ids.push([token.actor.name, token.actor.id]);\n        }\n    }\n}\n\n\nif(ids.length < 1){\n    ui.notifications.error('Please add the player names, followed by their ids in the ids array inside the macro code, or select some tokens.');\n    return;\n}\n\nlet html = \"<table> <tr> <th> Name </th> <th> Beats </th> <th> Arc. Beats </th> </tr>\";\n\nids.forEach((ele,index,array) => {\nlet actor = game.actors.get(ele[1]);\nlet progress = actor?.system.progress;\nlet beats = progress ? progress.reduce((acc, cur) => {\n\nreturn cur.beats > 0 ? acc + cur.beats : acc;\n}, 0) : \"ERR\";\nbeats += actor?.system.beats + actor?.system.experience*5;\nlet arcBeats = progress ? progress.reduce((acc, cur) => {\n\nreturn cur.arcaneBeats > 0 ? acc + cur.arcaneBeats : acc;\n}, 0) : \"ERR\";\narcBeats += actor?.system.arcaneBeats + actor?.system.arcaneExperience*5;\n\nhtml += \"<tr>\"\n+ \"<td>\" + ele[0] + \"</td>\"\n+ \"<td>\" + beats + \"</td>\"\n+ \"<td>\" + arcBeats + \"</td>\"\n+ \"</tr>\"\n});\nhtml += \"</table>\";\n\n\nconst chatData = {\nuser: game.user._id,\ntype: CONST.CHAT_MESSAGE_TYPES.OTHER,\ncontent: html,\nflavor: \"Experience Total\"\n};\nChatMessage.create(chatData);","flags":{"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.69A5JIuaQpIDrMvP"}},"ownership":{"default":0,"rgSvVH0I52G7WbzM":3,"rr0EVDhTVIBqlfEm":3},"_stats":{"systemId":"mta","systemVersion":"0.10.0","coreVersion":"10.286","createdTime":1664281611983,"modifiedTime":1664281750632,"lastModifiedBy":"rr0EVDhTVIBqlfEm"},"folder":null,"sort":0,"_id":"Km2p3ZSotGSUnoyF"}
{"_id":"PAdlVhC1p3VgpK6o","name":"+1 Arcane Beats (Obsession)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_obsession.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgress(\"Obsession\", 0, 1);\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got an Arcane Beat for an Obsession!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.yf4zeplDThSSC9ZL"}}}
{"_id":"V4fEECSfXT0sA39n","name":"Add Beats (Custom)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_custom.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgressDialogue();\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got some Beats!\"\n});\n}\n}}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.S2kX3B4LHEv7tncn"}}}
{"_id":"aWPH6g9QGSNSUmnB","name":"+1 Arcane Beats (Condition)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat-arcane_condition.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgress(\"Condition\", 0, 1);\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got an Arcane Beat for a magical Condition!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.o6wU35X0eZnWP84W"}}}
{"_id":"kUA6xsI3buBjxHYO","name":"+1 Beat (Dram. Failure)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_dramatic-failure.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgress(\"Dram. Failure\", 1, 0);\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got a Beat for a dramatic failure!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.rkR1tyt1i1FBjy7o"}}}
{"_id":"qHIPuNphSqqKOrIw","name":"+1 Beats (Condition)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_condition.svg","scope":"global","command":"for(let t of canvas.tokens.controlled){\n if(t){\nif(t.actor){\nconsole.trace(t)\nt.actor.addProgress(\"Condition\", 1, 0);\nChatMessage.create({\nspeaker: ChatMessage.getSpeaker({actor: t.actor}),\ncontent: \"Got a Beat for a Condition!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.mJjzMNOvJzsSv15W"}}}
{"_id":"qWCvIRp3AH6eEH9S","name":"+1 Beat (Aspiration)","type":"script","author":"rgSvVH0I52G7WbzM","img":"systems/mta/icons/macros/beat_aspiration.svg","scope":"global","command":"for(let token of canvas.tokens.controlled){\nif(token){\nif(token.actor){\ntoken.actor.addProgress(\"Aspiration\", 1, 0);\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({actor: token.actor}),\ncontent: \"Got a Beat for an Aspiration!\"\n});\n}\n}\n}","folder":null,"sort":0,"permission":{"default":1,"rgSvVH0I52G7WbzM":3},"flags":{"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.XLSQtEUXQob1dk3L"}}}
{"name":"Show Available Beats","type":"script","author":"rr0EVDhTVIBqlfEm","img":"systems/mta/icons/macros/beats-available.svg","scope":"global","command":"const ids = [];\n// Example: const ids = [[\"Tylor\", \"1a02UQZRhupn5234\"], [\"April\", \"bGgpNeYcBWVCdhAk\"], [\"Elaine\", \"hOppsrlQbSCyjjFw\"]]; \n\nfor(let token of canvas.tokens.controlled){\n    if(token){\n        if(token.actor){\n            ids.push([token.actor.name, token.actor.id]);\n        }\n    }\n}\n\n\nif(ids.length < 1){\n    ui.notifications.error('Please add the player names, followed by their ids in the ids array inside the macro code, or select some tokens.');\n    return;\n}\n\n\nlet html = \"<table> <tr> <th> Name </th> <th> Beats </th> <th> Arc. Beats </th> </tr>\";\n\nids.forEach((ele,index,array) => {\nlet actor = game.actors.get(ele[1]);\nlet progress = actor?.system.progress;\nprogress  = [{\n        name: \"INITIAL\",\n        beats: actor?.system.beats + 5 * actor?.system.experience,\n        arcaneBeats: actor?.system.arcaneBeats + 5 * actor?.system.arcaneExperience\n      }].concat(progress);\n\nlet beats = progress.reduce((acc, cur) => {\n        if (cur && cur.beats) return acc + +cur.beats;\n        else return acc;\n      }, 0);\nlet beats_computed = beats % 5;\nlet experience_computed = Math.floor(beats / 5);\n\nlet arcaneBeats = progress.reduce((acc, cur) => {\n        if (cur && cur.arcaneBeats) return acc + 1 * cur.arcaneBeats;\n        else return acc;\n      }, 0);\n      let arcaneBeats_computed = arcaneBeats % 5;\n      let arcaneExperience_computed = Math.floor(arcaneBeats / 5);\n\nhtml += \"<tr>\"\n+ \"<td>\" + ele[0] + \"</td>\"\n+ \"<td>\" + beats + \"</td>\"\n+ \"<td>\" + arcaneBeats + \"</td>\"\n+ \"</tr>\"\n});\nhtml += \"</table>\";\n\n\nconst chatData = {\nuser: game.user._id,\ntype: CONST.CHAT_MESSAGE_TYPES.OTHER,\ncontent: html,\nflavor: \"Available Beats\"\n};\nChatMessage.create(chatData);","flags":{"furnace":{"runAsGM":true},"core":{"sourceId":"Macro.BVb2cJeL3Uy7vOut"}},"ownership":{"default":0,"rgSvVH0I52G7WbzM":3,"rr0EVDhTVIBqlfEm":3},"_stats":{"systemId":"mta","systemVersion":"0.10.0","coreVersion":"10.286","createdTime":1664281610915,"modifiedTime":1664281749664,"lastModifiedBy":"rr0EVDhTVIBqlfEm"},"folder":null,"sort":0,"_id":"ssD4BGCdAVQKbHZq"}
